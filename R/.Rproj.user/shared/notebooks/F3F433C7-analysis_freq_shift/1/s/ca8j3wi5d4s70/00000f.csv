"0","df_sync_data <- df_raw_data %>%"
"0","  filter(tap > 3) %>% # 1. Exclude initial adjusment period"
"0","  filter(DT > 50) %>% # 2. Ensure constant phase relationship"
"0","  group_by(group, subject, task, task_number, frequency) %>%"
"0","  mutate("
"0","    mean_async = mean.circular(circular(relphase)) / (2 * pi) / frequency * 1000"
"0","  ) %>%"
"0","  filter(abs(mean_async) < 150) %>% # 3. Exclude reactive responses"
"0","  dplyr::select(group, subject, task, task_number, tap, frequency, relphase) %>%"
"0","  ungroup()"
"0",""
"0","df_async_by_task <- df_sync_data %>%"
"0","  filter(frequency <= 3.7) %>%"
"0","  group_by(group, subject, task, task_number, frequency) %>%"
"0","  mutate(relphase = circular(relphase)) %>%"
"0","  summarise("
"0","    mean_relphase = mean.circular(relphase),"
"0","    sd_relphase = sd.circular(relphase),"
"0","    .groups = ""drop"""
"0","  ) %>%"
"0","  mutate(mean_async = as.numeric(mean_relphase) / (2 * pi) / frequency * 1000)"
"0",""
"0","df_async_freq_shift <- merge(df_async_by_task, df_max_freq_shift)"
