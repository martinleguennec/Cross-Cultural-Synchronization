"0","participants <- unique(df_raw_data$subject)"
"0",""
"0","df_freq_movement <- df_raw_data %>%"
"0","  filter(tap > 3 & task == 'sync') %>%"
"0","  group_by(group, subject, task, task_number, frequency) %>%"
"0","  summarise("
"0","    freq = mean(1/period, na.rm = TRUE), "
"0","    sd_freq = sd(1/period, na.rm = TRUE),"
"0","    n = sum(!is.na(period)),"
"0","    .groups = ""drop"""
"0","  ) %>%"
"0","  mutate("
"0","    se = sd_freq / sqrt(n),"
"0","    t_val = qt(0.975, df = n - 1),"
"0","    ci_lower = freq - t_val * se,"
"0","    ci_upper = freq + t_val * se,"
"0","    frequency_shift = freq - frequency"
"0","  ) %>%"
"0","  group_by(group, subject, task, task_number) %>%"
"0","  mutate("
"0","    max_freq = max(freq),"
"0","    rate_at_max_freq = frequency[which.max(freq)],"
"0","    ci_upper_at_max_freq = ci_upper[which.max(freq)],"
"0","    ci_lower_at_max_freq = ci_lower[which.max(freq)],"
"0","    is_max = ifelse("
"0","      frequency == rate_at_max_freq, "
"0","      ""Maximum"", "
"0","      ""Submaximum"""
"0","    ),"
"0","    position_relative_to_max = ifelse("
"0","      frequency < rate_at_max_freq, "
"0","      ""Before maximum"", "
"0","      ifelse("
"0","        frequency == rate_at_max_freq, "
"0","        ""Maximum"", "
"0","        ""After maximum"""
"0","      )"
"0","    ),"
"0","    first_plateau_in_ci = min("
"0","      ifelse(freq >= ci_lower_at_max_freq, frequency, NA), "
"0","      na.rm = TRUE"
"0","    ),"
"0","    plateau_classification = ifelse("
"0","      frequency == rate_at_max_freq, ""Maximum"","
"0","      ifelse("
"0","        ci_upper_at_max_freq >= 6.1, ""Before maximum"","
"0","        ifelse("
"0","          frequency < first_plateau_in_ci, "
"0","          ""Before maximum"", "
"0","          ""In the CI"""
"0","          )"
"0","      )"
"0","    )"
"0","  ) %>%"
"0","  ungroup()"
